<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOE K4 ĐỀ SỐ 06</title>
    <!-- Libraries from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
      body { font-family: 'Nunito', sans-serif; }
      
      /* Custom Scrollbar */
      .custom-scrollbar::-webkit-scrollbar { width: 8px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
      
      /* Simple Animations */
      @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }
      .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
      
      @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
      .animate-slide-up { animation: slideUp 0.4s ease-out forwards; }

      @keyframes bounceShort { 
        0%, 100% { transform: translateY(0); } 
        50% { transform: translateY(-5px); } 
      }
      .animate-bounce-short { animation: bounceShort 1s infinite; }
    </style>
<script type="importmap">
{
  "imports": {
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0"
  }
}
</script>
</head>
<body class="bg-slate-100 text-slate-800 antialiased">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- 1. TYPES & ENUMS ---
        const QuestionType = {
            MULTIPLE_CHOICE: 'MULTIPLE_CHOICE',
            FILL_IN_BLANK: 'FILL_IN_BLANK',
            REARRANGE: 'REARRANGE'
        };

        const GameState = {
            START: 'START',
            PLAYING: 'PLAYING',
            FINISHED: 'FINISHED'
        };

        // --- 2. CONSTANTS & DATA ---
        const cleanUrl = (url) => {
            if (!url) return undefined;
            return url.trim()
                .replace(/\s+/g, '') // Remove spaces
                .replace(/res\.ioe\.vnzedu/, 'res.ioe.vn/edu') // Fix domain typos
                .replace(/res\.ioe\.vii/, 'res.ioe.vn')
                .replace(/res\.ioe\.vm/, 'res.ioe.vn')
                .replace(/Audio\s*mp3/i, 'Audio.mp3') // Fix extension
                .replace(/ImageExam\s*(\d)/, 'ImageExam/$1') // Fix path separators
                .replace(/Olympic\s*ExamData/, 'OlympicExamData')
                .replace(/EOlympic\s*ExamData/, 'EOlympic/ExamData')
                .replace(/'/g, '') // Remove accidental quotes
                .replace(/Audio-mp3/i, 'Audio.mp3');
        };

        // Full Question Data for IOE K4 No. 06
        const QUIZ_DATA = [
  { id: 1, type: QuestionType.FILL_IN_BLANK, questionText: "When did you c_ _ e back?", correctAnswer: "om", explanation: "Come back: Quay lại." },
  { id: 2, type: QuestionType.MULTIPLE_CHOICE, questionText: "David plays football on _______.", options: ["morning", "June", "Sundays", "every Saturday"], correctAnswer: "Sundays", explanation: "On + Thứ (số nhiều chỉ thói quen)." },
  { id: 3, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Today", "December.", "is the", "first of"], correctAnswer: "Today is the first of December.", explanation: "Hôm nay là ngày mùng 1 tháng 12." },
  { id: 4, type: QuestionType.MULTIPLE_CHOICE, questionText: "A: Do they come from Japan? - B: …", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/3/636505738926925877_566X320.jpg"), options: ["Yes, they are.", "No, they aren’t.", "Yes, they do.", "No, they don’t."], correctAnswer: "No, they don’t.", explanation: "Câu hỏi Do they... trả lời Yes, they do / No, they don't." },
  { id: 5, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["a green", "Is it", "it isn’t.", "kite? – No,"], correctAnswer: "Is it a green kite? – No, it isn’t.", explanation: "Đó có phải là con diều màu xanh không? Không phải." },
  { id: 6, type: QuestionType.FILL_IN_BLANK, questionText: "She likes playing vo_ _ _ _ _ _ _ _ .", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/26/636788545103106710_566X320.jpg"), correctAnswer: "lleyball", explanation: "Volleyball: Bóng chuyền." },
  { id: 7, type: QuestionType.MULTIPLE_CHOICE, questionText: "What can ... do? – I can dance and sing.", options: ["I", "he", "you", "me"], correctAnswer: "you", explanation: "Hỏi You -> Trả lời I." },
  { id: 8, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ e is Mary? – She’s at school now.", correctAnswer: "Wher", explanation: "Where: Ở đâu." },
  { id: 9, type: QuestionType.FILL_IN_BLANK, questionText: "This is my m_ ther.", correctAnswer: "o", explanation: "Mother: Mẹ." },
  { id: 10, type: QuestionType.FILL_IN_BLANK, questionText: "Would you like some or_ _ ge juice?", correctAnswer: "an", explanation: "Orange juice: Nước cam." },
  { id: 11, type: QuestionType.FILL_IN_BLANK, questionText: "Happy birthday, Phong. This gift is _ _ _ you.", correctAnswer: "for", explanation: "For you: Cho bạn." },
  { id: 12, type: QuestionType.FILL_IN_BLANK, questionText: "A: _ _ _ old are you? B: I’m ten years old.", correctAnswer: "How", explanation: "How old: Bao nhiêu tuổi." },
  { id: 13, type: QuestionType.MULTIPLE_CHOICE, questionText: "Where … my trousers, mom?", options: ["am", "is", "are", "do"], correctAnswer: "are", explanation: "Trousers (số nhiều) -> Are." },
  { id: 14, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the odd one out:", options: ["skating", "play", "climbing", "cycling"], correctAnswer: "play", explanation: "'Play' là động từ nguyên thể, còn lại là V-ing." },
  { id: 15, type: QuestionType.MULTIPLE_CHOICE, questionText: "Please open the door. It’s ... in here.", options: ["hot", "cold", "warm", "rainy"], correctAnswer: "hot", explanation: "Nóng (Hot) nên cần mở cửa." },
  { id: 16, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and tick:", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206448448786308_Audio.mp3"), options: ["My birthday is in September.", "His birthday is in December.", "My birthday is in October.", "His birthday is in August."], correctAnswer: "My birthday is in October.", explanation: "Nghe audio." },
  { id: 17, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["on", "the", "are", "bed.", "The toys"], correctAnswer: "The toys are on the bed.", explanation: "Đồ chơi ở trên giường." },
  { id: 18, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ morning, Miss Hoa.", correctAnswer: "Good", explanation: "Good morning: Chào buổi sáng." },
  { id: 19, type: QuestionType.MULTIPLE_CHOICE, questionText: "What has the new girl got?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636162036561974471_Audio.mp3"), options: ["Glasses", "Short hair", "Curly hair.", "All are correct."], correctAnswer: "Curly hair.", explanation: "Nghe audio: Tóc xoăn." },
  { id: 20, type: QuestionType.MULTIPLE_CHOICE, questionText: "Do you have pets? - Yes, ... .", options: ["I has a dog", "I have a dog", "I have a dogs", "I have two dog"], correctAnswer: "I have a dog", explanation: "I have a dog." },
  { id: 21, type: QuestionType.FILL_IN_BLANK, questionText: "It is a r_ _ nd ball.", correctAnswer: "ou", explanation: "Round: Tròn." },
  { id: 22, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["you yesterday?", "Where", "were"], correctAnswer: "Where were you yesterday?", explanation: "Hôm qua bạn ở đâu?" },
  { id: 23, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["for", "doll", "you.", "This", "is"], correctAnswer: "This doll is for you.", explanation: "Con búp bê này là cho bạn." },
  { id: 24, type: QuestionType.FILL_IN_BLANK, questionText: "Work in pairs, ple_ _ _ .", correctAnswer: "ase", explanation: "Please: Làm ơn/Vui lòng." },
  { id: 25, type: QuestionType.FILL_IN_BLANK, questionText: "I would like t_ o bananas.", correctAnswer: "w", explanation: "Two: 2." },
  { id: 26, type: QuestionType.FILL_IN_BLANK, questionText: "What _ _ _ _ does your family have breakfast? - At 7 o’clock.", correctAnswer: "time", explanation: "What time: Mấy giờ." },
  { id: 27, type: QuestionType.MULTIPLE_CHOICE, questionText: "... does your father get up? – At 5:30 every day.", options: ["How old", "What time", "How often", "What grade"], correctAnswer: "What time", explanation: "Hỏi giờ -> What time." },
  { id: 28, type: QuestionType.FILL_IN_BLANK, questionText: "She drew a _ _ _ _ er.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/3/636505770918298612_566X320.jpg"), correctAnswer: "flow", explanation: "Flower: Bông hoa." },
  { id: 29, type: QuestionType.MULTIPLE_CHOICE, questionText: "I ___ at Chu Van An Primary School. Nice to meet you, Linh. – Nice to meet you, too.", options: ["go", "see", "study", "meet"], correctAnswer: "study", explanation: "Study at: Học tại." },
  { id: 30, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["in", "May.", "is", "Uncle Ho’s", "birthday"], correctAnswer: "Uncle Ho’s birthday is in May.", explanation: "Sinh nhật Bác Hồ vào tháng 5." },
  { id: 31, type: QuestionType.FILL_IN_BLANK, questionText: "My fav_ _ _ ite subject is Art.", correctAnswer: "our", explanation: "Favourite: Yêu thích." },
  { id: 32, type: QuestionType.FILL_IN_BLANK, questionText: "Jim can speak Eng_ _ _ h but cannot speak Vietnamese.", correctAnswer: "lis", explanation: "English: Tiếng Anh." },
  { id: 33, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["What", "Andy?", "is", "the", "time,"], correctAnswer: "What is the time, Andy?", explanation: "Mấy giờ rồi Andy?" },
  { id: 34, type: QuestionType.MULTIPLE_CHOICE, questionText: "What is her ...? - She is a teacher.", options: ["name", "job", "age", "old"], correctAnswer: "job", explanation: "Hỏi nghề nghiệp -> Job." },
  { id: 35, type: QuestionType.FILL_IN_BLANK, questionText: "Give me a pac_ _ t of milk, please..", correctAnswer: "ke", explanation: "Packet: Hộp/Gói." },
  { id: 36, type: QuestionType.FILL_IN_BLANK, questionText: "A: Do you like coffee? - B: No, I p_ _ _ _ _ tea.", correctAnswer: "refer", explanation: "Prefer: Thích hơn." },
  { id: 37, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["studied", "my sister", "last Tuesday.", "I", "English with"], correctAnswer: "I studied English with my sister last Tuesday.", explanation: "Tôi học tiếng Anh với chị tôi thứ 3 tuần trước." },
  { id: 38, type: QuestionType.MULTIPLE_CHOICE, questionText: "Thank you very much. – You’re ... .", options: ["well", "stay", "welcome", "come"], correctAnswer: "welcome", explanation: "You're welcome: Không có chi." },
  { id: 39, type: QuestionType.FILL_IN_BLANK, questionText: "Nam is tall. Trung is tall_ _ .", correctAnswer: "er", explanation: "Taller: Cao hơn (So sánh hơn)." },
  { id: 40, type: QuestionType.MULTIPLE_CHOICE, questionText: "July ... the seventh month of the year.", options: ["is", "isn’t", "are", "and"], correctAnswer: "is", explanation: "July (số ít) -> Is." },
  { id: 41, type: QuestionType.MULTIPLE_CHOICE, questionText: "What’s ...? – That’s an eraser.", options: ["it", "this", "that", "its"], correctAnswer: "that", explanation: "Câu trả lời dùng 'That' -> Câu hỏi thường dùng 'that'." },
  { id: 42, type: QuestionType.FILL_IN_BLANK, questionText: "Tha_ _ you very much.", correctAnswer: "nk", explanation: "Thank you." },
  { id: 43, type: QuestionType.FILL_IN_BLANK, questionText: "W_ _ _ _ is Mary from?", correctAnswer: "here", explanation: "Where: Ở đâu." },
  { id: 44, type: QuestionType.FILL_IN_BLANK, questionText: "Don’t visit Paris in J_ _ _ . June is better.", correctAnswer: "uly", explanation: "July: Tháng 7." },
  { id: 45, type: QuestionType.FILL_IN_BLANK, questionText: "He is my fri_ _ d.", correctAnswer: "en", explanation: "Friend: Bạn." },
  { id: 46, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ en is your birthday?", correctAnswer: "Wh", explanation: "When: Khi nào." },
  { id: 47, type: QuestionType.FILL_IN_BLANK, questionText: "We’re late f_ _ school.", correctAnswer: "or", explanation: "Late for: Muộn." },
  { id: 48, type: QuestionType.FILL_IN_BLANK, questionText: "I can t_ _ k with my mouth.", correctAnswer: "al", explanation: "Talk: Nói." },
  { id: 49, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["very much.", "She", "her", "loves", "school"], correctAnswer: "She loves her school very much.", explanation: "Cô ấy rất yêu trường." },
  { id: 50, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["When", "is", "the", "next Art", "class?"], correctAnswer: "When is the next Art class?", explanation: "Khi nào có tiết Mỹ thuật tiếp theo?" },
  { id: 51, type: QuestionType.FILL_IN_BLANK, questionText: "Here you a_ _ . – Thank you.", correctAnswer: "re", explanation: "Here you are." },
  { id: 52, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["grandpa", "the country.", "Last Sunday, I", "in", "visited my"], correctAnswer: "Last Sunday, I visited my grandpa in the country.", explanation: "Chủ nhật trước tôi thăm ông ở quê." },
  { id: 53, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the odd one out:", options: ["his", "he", "she", "they"], correctAnswer: "his", explanation: "'His' là tính từ sở hữu, còn lại là đại từ nhân xưng." },
  { id: 54, type: QuestionType.FILL_IN_BLANK, questionText: "It’s su_ ny in Hue.", correctAnswer: "n", explanation: "Sunny: Có nắng." },
  { id: 55, type: QuestionType.FILL_IN_BLANK, questionText: "W_ _ _ is your mother’s birthday, Hoa?", correctAnswer: "hen", explanation: "When: Khi nào." },
  { id: 56, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["now?", "my", "sister. Where", "I can’t find", "is she"], correctAnswer: "I can’t find my sister. Where is she now?", explanation: "Tôi không tìm thấy em gái. Em ấy đâu rồi?" },
  { id: 57, type: QuestionType.MULTIPLE_CHOICE, questionText: "What do you ... during Art lessons?", options: ["do", "to", "don’t", "does"], correctAnswer: "do", explanation: "What do you do... (Bạn làm gì)." },
  { id: 58, type: QuestionType.MULTIPLE_CHOICE, questionText: "The children come to the computer room every … and ….", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/3/636505712816136606_Audio.mp3"), options: ["Tuesday - Wednesday", "Monday - Thursday", "Tuesday – Thursday", "Monday - Wednesday"], correctAnswer: "Tuesday – Thursday", explanation: "Nghe audio." },
  { id: 59, type: QuestionType.FILL_IN_BLANK, questionText: "His favourite hobby is playing c_ _ _ s.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/16/636175028753267186_566X320.jpg"), correctAnswer: "hes", explanation: "Chess: Cờ vua." },
  { id: 60, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["learn", "Where does", "English songs?", "Mary", "games and"], correctAnswer: "Where does Mary learn games and English songs?", explanation: "Mary học trò chơi và bài hát tiếng Anh ở đâu?" },
  { id: 61, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and tick:", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206446559934990_Audio.mp3"), options: ["It’s her birthday today.", "It’s my birthday today.", "It’s his birthday today.", "It’s his birthday."], correctAnswer: "It’s my birthday today.", explanation: "Nghe audio." },
  { id: 62, type: QuestionType.MULTIPLE_CHOICE, questionText: "This is my … timetable.", options: ["home", "school", "school bus", "chair"], correctAnswer: "school", explanation: "School timetable: Thời khóa biểu." },
  { id: 63, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the", "school library?", "go to", "How often", "do you"], correctAnswer: "How often do you go to the school library?", explanation: "Bạn có thường xuyên đến thư viện trường không?" },
  { id: 64, type: QuestionType.MULTIPLE_CHOICE, questionText: "This is my ... . It’s small.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/22/635207136012776117_566X320.jpg"), options: ["kitchen", "bathroom", "bedroom", "living room"], correctAnswer: "bedroom", explanation: "Nhìn tranh: Phòng ngủ." },
  { id: 65, type: QuestionType.MULTIPLE_CHOICE, questionText: "I ... my teeth in the morning.", options: ["do", "brush", "have", "does"], correctAnswer: "brush", explanation: "Brush teeth: Đánh răng." },
  { id: 66, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["trees", "are", "in your garden?", "there", "How many"], correctAnswer: "How many trees are there in your garden?", explanation: "Có bao nhiêu cái cây trong vườn?" },
  { id: 67, type: QuestionType.FILL_IN_BLANK, questionText: "A: Wh_ _ _ ’s your school? - B: It’s in Nguyen Hue Street.", correctAnswer: "ere", explanation: "Where: Ở đâu." },
  { id: 68, type: QuestionType.MULTIPLE_CHOICE, questionText: "Look! That’s a ... . It’s beautiful.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/23/635208389669674230_566X320.jpg"), options: ["car", "chair", "flower", "rainbow"], correctAnswer: "rainbow", explanation: "Nhìn tranh: Cầu vồng." },
  { id: 69, type: QuestionType.FILL_IN_BLANK, questionText: "Welcome _ _ my new school!", correctAnswer: "to", explanation: "Welcome to: Chào mừng đến." },
  { id: 70, type: QuestionType.FILL_IN_BLANK, questionText: "Wh_ _ _ are the maps? – They are on the wall", correctAnswer: "ere", explanation: "Where: Ở đâu." },
  { id: 71, type: QuestionType.FILL_IN_BLANK, questionText: "Tom can s_ _ _ k Vietnamese.", correctAnswer: "pea", explanation: "Speak: Nói." },
  { id: 72, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["friend.", "That", "my", "new", "is"], correctAnswer: "That is my new friend.", explanation: "Đó là bạn mới của tôi." },
  { id: 73, type: QuestionType.FILL_IN_BLANK, questionText: "Is your classr_ _ m big? – Yes, it is.", correctAnswer: "oo", explanation: "Classroom: Lớp học." },
  { id: 74, type: QuestionType.MULTIPLE_CHOICE, questionText: "How … is he? – He is ten years old.", options: ["young", "time", "old", "food"], correctAnswer: "old", explanation: "How old: Bao nhiêu tuổi." },
  { id: 75, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the weekend.", "not go", "I do", "at", "to school"], correctAnswer: "I do not go to school at the weekend.", explanation: "Tôi không đi học vào cuối tuần." },
  { id: 76, type: QuestionType.FILL_IN_BLANK, questionText: "Taylor Swift is Ameri_ _ _ singer.", correctAnswer: "can", explanation: "American: Người Mỹ." },
  { id: 77, type: QuestionType.MULTIPLE_CHOICE, questionText: "Where is Mai?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790852910098621_Audio.mp3"), options: ["She’s in her bedroom.", "She’s in the library.", "She’s in the kitchen.", "She’s in the garden."], correctAnswer: "She’s in the kitchen.", explanation: "Nghe audio." },
  { id: 78, type: QuestionType.MULTIPLE_CHOICE, questionText: "... the weather today? - It’s windy.", options: ["What’s", "How", "How’s", "Now"], correctAnswer: "How’s", explanation: "How's the weather: Thời tiết thế nào." },
  { id: 79, type: QuestionType.FILL_IN_BLANK, questionText: "My new pencils are _ _ the table.", correctAnswer: "on", explanation: "On: Ở trên." },
  { id: 80, type: QuestionType.MULTIPLE_CHOICE, questionText: "I can ... a tree.", options: ["fly", "write", "read", "climb"], correctAnswer: "climb", explanation: "Climb a tree: Trèo cây." },
  { id: 81, type: QuestionType.FILL_IN_BLANK, questionText: "SUMMAR_ ", correctAnswer: "Y", explanation: "Summary: Tóm tắt." },
  { id: 82, type: QuestionType.FILL_IN_BLANK, questionText: "My favourite sub_ _ _ t is Music.", correctAnswer: "jec", explanation: "Subject: Môn học." },
  { id: 83, type: QuestionType.FILL_IN_BLANK, questionText: "Excuse me, where is the nearest post _ _ _ _ _ _ ?", correctAnswer: "office", explanation: "Post office: Bưu điện." },
  { id: 84, type: QuestionType.MULTIPLE_CHOICE, questionText: "That umbrella is ... .", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/22/635207213501282221_566X320.jpg"), options: ["green", "red", "blue", "black"], correctAnswer: "red", explanation: "Nhìn tranh: Màu đỏ." },
  { id: 85, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["school bags", "the table.", "on", "Our", "are"], correctAnswer: "Our school bags are on the table.", explanation: "Cặp sách của chúng tôi ở trên bàn." },
  { id: 86, type: QuestionType.MULTIPLE_CHOICE, questionText: "This is ... teacher.", options: ["me", "I", "for", "my"], correctAnswer: "my", explanation: "My teacher: Giáo viên của tôi." },
  { id: 87, type: QuestionType.MULTIPLE_CHOICE, questionText: "I ... tired.", options: ["a", "am", "an", "and"], correctAnswer: "am", explanation: "I am." },
  { id: 88, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["sat", "together.", "in the living room", "My family", "and watched TV"], correctAnswer: "My family sat in the living room and watched TV together.", explanation: "Gia đình tôi ngồi phòng khách và xem TV cùng nhau." },
  { id: 89, type: QuestionType.FILL_IN_BLANK, questionText: "I play the guitar _ _ home on Tuesday afternoon.", correctAnswer: "at", explanation: "At home: Ở nhà." },
  { id: 90, type: QuestionType.MULTIPLE_CHOICE, questionText: "Mary studies Maths ... 7 a.m ... 8 a.m on Sunday.", options: ["to / at", "from / in", "from / to", "on/ to"], correctAnswer: "from / to", explanation: "From... to...: Từ... đến..." },
  { id: 91, type: QuestionType.MULTIPLE_CHOICE, questionText: "Odd one out:", options: ["America", "English", "Canada", "France"], correctAnswer: "English", explanation: "'English' là ngôn ngữ/quốc tịch, còn lại là tên nước." },
  { id: 92, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the", "Adam", "United States.", "from", "I’m"], correctAnswer: "I’m Adam from the United States.", explanation: "Tôi là Adam đến từ Mỹ." },
  { id: 93, type: QuestionType.FILL_IN_BLANK, questionText: "What c_ _ _ _ _ is this? – It’s brown.", correctAnswer: "olour", explanation: "Colour: Màu sắc." },
  { id: 94, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and tick:", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206412650930497_Audio.mp3"), options: ["Where is your school bag?", "Where is your school bus?", "Where is your school yard?", "Where is your school lab?"], correctAnswer: "Where is your school lab?", explanation: "Nghe audio." },
  { id: 95, type: QuestionType.FILL_IN_BLANK, questionText: "I can r_ _ e a bicycle.", correctAnswer: "id", explanation: "Ride: Lái (xe đạp)." },
  { id: 96, type: QuestionType.MULTIPLE_CHOICE, questionText: "I ... Andy. I’m from Holland.", options: ["are", "am", "is", "name"], correctAnswer: "am", explanation: "I am." },
  { id: 97, type: QuestionType.FILL_IN_BLANK, questionText: "He likes this _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206449859028785_Audio.mp3"), correctAnswer: "car", explanation: "Nghe audio: car." },
  { id: 98, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["doing? – She", "What’s", "dancing.", "is", "Mai"], correctAnswer: "What’s Mai doing? – She is dancing.", explanation: "Mai đang làm gì? Cô ấy đang nhảy." },
  { id: 99, type: QuestionType.MULTIPLE_CHOICE, questionText: "She is my ... .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206445203200607_Audio.mp3"), options: ["mother", "teacher", "sister", "father"], correctAnswer: "mother", explanation: "Nghe audio: Mẹ." },
  { id: 100, type: QuestionType.MULTIPLE_CHOICE, questionText: "... a round ball.", options: ["Is it", "It’s", "What is", "They are"], correctAnswer: "It’s", explanation: "It is." },
  { id: 101, type: QuestionType.MULTIPLE_CHOICE, questionText: "Simon can … English and Vietnamese.", options: ["say", "stay", "speak", "watch"], correctAnswer: "speak", explanation: "Speak: Nói (ngôn ngữ)." },
  { id: 102, type: QuestionType.MULTIPLE_CHOICE, questionText: "... are these? - They’re my sisters.", options: ["Who", "What", "How", "Where"], correctAnswer: "Who", explanation: "Who: Ai." },
  { id: 103, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["a", "teacher.", "mother", "My", "is"], correctAnswer: "My mother is a teacher.", explanation: "Mẹ tôi là giáo viên." },
  { id: 104, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["late", "We are", "for school. Let’s", "run."], correctAnswer: "We are late for school. Let’s run.", explanation: "Chúng ta muộn học rồi. Chạy thôi." },
  { id: 105, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["I have", "or", "fish.", "birds", "no"], correctAnswer: "I have no birds or fish.", explanation: "Tôi không có chim hay cá." },
  { id: 106, type: QuestionType.FILL_IN_BLANK, questionText: "The name of my _ _ _ _ _ _ _ _ is Thomas.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/25/636787717088170105_566X320.jpg"), correctAnswer: "goldfish", explanation: "Goldfish: Cá vàng." },
  { id: 107, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and choose the correct response.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/3/636505717658959378_Audio.mp3"), options: ["Yes, I do.", "No, I’m not.", "Yes, I did.", "No, I wasn’t."], correctAnswer: "Yes, I do.", explanation: "Nghe audio." },
  { id: 108, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Maths lesson.", "studying", "I’m", "for my"], correctAnswer: "I’m studying for my Maths lesson.", explanation: "Tôi đang học cho bài Toán." },
  { id: 109, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["one.", "red", "I", "like", "the"], correctAnswer: "I like the red one.", explanation: "Tôi thích cái màu đỏ." },
  { id: 110, type: QuestionType.MULTIPLE_CHOICE, questionText: "What time do you usually get ... in the morning?", options: ["down", "on", "up", "over"], correctAnswer: "up", explanation: "Get up: Thức dậy." },
  { id: 111, type: QuestionType.FILL_IN_BLANK, questionText: "Peter ha_ many rulers.", correctAnswer: "s", explanation: "Has: Có." },
  { id: 112, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["we have", "on", "Thursdays?", "do", "What"], correctAnswer: "What do we have on Thursdays?", explanation: "Chúng ta có môn gì vào thứ Năm?" },
  { id: 113, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ Ginny playing football?", correctAnswer: "Is", explanation: "Is... playing: Đang chơi phải không?" },
  { id: 114, type: QuestionType.MULTIPLE_CHOICE, questionText: "Mary and Tom live ... England.", options: ["in", "on", "of", "from"], correctAnswer: "in", explanation: "Live in: Sống ở." },
  { id: 115, type: QuestionType.FILL_IN_BLANK, questionText: "Would you like a ham_ _ _ _ _ _ ?", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/16/636175035258752485_566X320.jpg"), correctAnswer: "burger", explanation: "Hamburger: Bánh mì kẹp thịt." },
  { id: 116, type: QuestionType.FILL_IN_BLANK, questionText: "Bat Trang Primary School is in Bat Trang V_ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790850676378842_Audio.mp3"), correctAnswer: "illage", explanation: "Village: Làng." },
  { id: 117, type: QuestionType.MULTIPLE_CHOICE, questionText: "Lan is a hard-working student. She ... to work about 45 hours a week.", options: ["have", "has", "do", "does"], correctAnswer: "has", explanation: "Has to work: Phải làm việc." },
  { id: 118, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["from", "My father", "Japan.", "is"], correctAnswer: "My father is from Japan.", explanation: "Bố tôi đến từ Nhật Bản." },
  { id: 119, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["sixth month", "June", "of", "the year.", "is the"], correctAnswer: "June is the sixth month of the year.", explanation: "Tháng Sáu là tháng thứ 6 trong năm." },
  { id: 120, type: QuestionType.MULTIPLE_CHOICE, questionText: "Yoko is ... Japan.", options: ["at", "under", "up", "from"], correctAnswer: "from", explanation: "From: Đến từ." },
  { id: 121, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["I’m sure", "a present", "Tony also", "has", "for me."], correctAnswer: "I’m sure Tony also has a present for me.", explanation: "Tôi chắc chắn Tony cũng có quà cho tôi." },
  { id: 122, type: QuestionType.MULTIPLE_CHOICE, questionText: "Does your sister ... fun at school?", options: ["to have", "have", "has", "to has"], correctAnswer: "have", explanation: "Does + S + V nguyên thể (have)." },
  { id: 123, type: QuestionType.MULTIPLE_CHOICE, questionText: "I can speak ... .", options: ["Vietnam", "England", "America", "English"], correctAnswer: "English", explanation: "Speak English." },
  { id: 124, type: QuestionType.FILL_IN_BLANK, questionText: "W_ _ do you like Music? - Because I like to sing.", correctAnswer: "hy", explanation: "Why: Tại sao." },
  { id: 125, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["We", "at", "yesterday.", "were", "school"], correctAnswer: "We were at school yesterday.", explanation: "Hôm qua chúng tôi ở trường." },
  { id: 126, type: QuestionType.MULTIPLE_CHOICE, questionText: "Uncle Ho’s birthday is in ... .", options: ["July", "May", "2013", "school"], correctAnswer: "May", explanation: "Tháng 5." },
  { id: 127, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["my", "favourite", "subject.", "Maths", "is"], correctAnswer: "Maths is my favourite subject.", explanation: "Toán là môn yêu thích của tôi." },
  { id: 128, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Please,", "give", "some", "me", "milk."], correctAnswer: "Please, give me some milk.", explanation: "Làm ơn cho tôi ít sữa." },
  { id: 129, type: QuestionType.FILL_IN_BLANK, questionText: "I’d like a cand_ .", correctAnswer: "y", explanation: "Candy: Kẹo." },
  { id: 130, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the odd one out.", options: ["Post office", "Bank", "Bakery", "Picnic"], correctAnswer: "Picnic", explanation: "'Picnic' là hoạt động, còn lại là địa điểm." },
  { id: 131, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["and friendly.", "My teacher", "very beautiful", "looks"], correctAnswer: "My teacher looks very beautiful and friendly.", explanation: "Cô giáo tôi trông rất xinh đẹp và thân thiện." },
  { id: 132, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["November.", "Tomorrow is", "ninth", "the", "of"], correctAnswer: "Tomorrow is the ninth of November.", explanation: "Ngày mai là mùng 9 tháng 11." },
  { id: 133, type: QuestionType.MULTIPLE_CHOICE, questionText: "The first day of a new week is ___.", options: ["Friday", "Thursday", "Tuesday", "Monday"], correctAnswer: "Monday", explanation: "Ngày đầu tuần là thứ Hai." },
  { id: 134, type: QuestionType.MULTIPLE_CHOICE, questionText: "What is Mai doing now? – She ___ a big house.", options: ["draws", "drawing", "is drawing", "draw"], correctAnswer: "is drawing", explanation: "Now -> Hiện tại tiếp diễn." },
  { id: 135, type: QuestionType.FILL_IN_BLANK, questionText: "Japan is a count_ _ in Asia.", correctAnswer: "ry", explanation: "Country: Quốc gia." },
  { id: 136, type: QuestionType.FILL_IN_BLANK, questionText: "I study _ t Ngo Gia Tu Primary School.", correctAnswer: "at", explanation: "Study at: Học tại." },
  { id: 137, type: QuestionType.MULTIPLE_CHOICE, questionText: "What’s his job? – He is a ... .", options: ["cinema", "hamburger", "teacher", "pizza"], correctAnswer: "teacher", explanation: "Teacher: Giáo viên." },
  { id: 138, type: QuestionType.FILL_IN_BLANK, questionText: "Do you like _ _ _ f?", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636162018894437933_566X320.jpg"), correctAnswer: "bee", explanation: "Beef: Thịt bò." },
  { id: 139, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["not tall", "but", "is", "She", "good-looking."], correctAnswer: "She is not tall but good-looking.", explanation: "Cô ấy không cao nhưng ưa nhìn." },
  { id: 140, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the incorrect word(s) in the following sentence: ’’I stay at home and watch TV in afternoon.’’", options: ["stay", "at home", "watch", "afternoon"], correctAnswer: "afternoon", explanation: "Phải là 'in the afternoon'." },
  { id: 141, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["many", "My sister", "English songs.", "can", "sing"], correctAnswer: "My sister can sing many English songs.", explanation: "Chị tôi có thể hát nhiều bài tiếng Anh." },
  { id: 142, type: QuestionType.FILL_IN_BLANK, questionText: "They are _ _ _ _ _ _ _ _ football in the school yard.", correctAnswer: "watching", explanation: "Watching football: Xem bóng đá." },
  { id: 143, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["you", "come", "Where", "do", "from?"], correctAnswer: "Where do you come from?", explanation: "Bạn đến từ đâu?" },
  { id: 144, type: QuestionType.FILL_IN_BLANK, questionText: "When is your mother’s bi_ _ _ day?", correctAnswer: "rth", explanation: "Birthday: Sinh nhật." },
  { id: 145, type: QuestionType.MULTIPLE_CHOICE, questionText: "Don’t … late or you’ll be late for school.", options: ["get in", "get on", "get up", "get out"], correctAnswer: "get up", explanation: "Get up late: Dậy muộn." },
  { id: 146, type: QuestionType.MULTIPLE_CHOICE, questionText: "When is your brother’s birthday? - ... .", options: ["It’s June", "It in June", "June it is", "It’s in June"], correctAnswer: "It’s in June", explanation: "It is in + Month." },
  { id: 147, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["is bigger.", "His house", "but", "my house", "is nice"], correctAnswer: "His house is bigger but my house is nice.", explanation: "Nhà cậu ấy to hơn nhưng nhà tôi đẹp." },
  { id: 148, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ John at home yesterday?", correctAnswer: "Was", explanation: "Was: Đã (quá khứ)." },
  { id: 149, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["On Mondays, Nam", "Maths.", "has", "English and"], correctAnswer: "On Mondays, Nam has English and Maths.", explanation: "Thứ Hai Nam có tiếng Anh và Toán." },
  { id: 150, type: QuestionType.FILL_IN_BLANK, questionText: "This is now a black and ora_ _ _ butterfly.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/Thi%20Th%E1%BB%AD/Thi_trai_nghiem_2021/Lop4/Nghe/E4_4(2).mp3"), correctAnswer: "nge", explanation: "Orange: Màu cam." },
  { id: 151, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["How", "are", "there?", "bicycles", "many"], correctAnswer: "How many bicycles are there?", explanation: "Có bao nhiêu cái xe đạp?" },
  { id: 152, type: QuestionType.FILL_IN_BLANK, questionText: "They took lots _ _ photos.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/D3_2.mp3"), correctAnswer: "of", explanation: "Lots of: Nhiều." },
  { id: 153, type: QuestionType.FILL_IN_BLANK, questionText: "I like to sing a_ _ dance.", correctAnswer: "nd", explanation: "And: Và." },
  { id: 154, type: QuestionType.MULTIPLE_CHOICE, questionText: "Her name is ... .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206431788977292_Audio.mp3"), options: ["Lili", "Laura", "Lisa", "Linda"], correctAnswer: "Linda", explanation: "Nghe audio: Linda." },
  { id: 155, type: QuestionType.MULTIPLE_CHOICE, questionText: "___ is your school, Mai? – My school is in Nguyen Trai Street.", options: ["How", "When", "Where", "What"], correctAnswer: "Where", explanation: "Where: Ở đâu." },
  { id: 156, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["doing?", "do", "like", "What", "you"], correctAnswer: "What do you like doing?", explanation: "Bạn thích làm gì?" },
  { id: 157, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["playing", "Linh", "the guitar.", "doesn’t like"], correctAnswer: "Linh doesn’t like playing the guitar.", explanation: "Linh không thích chơi guitar." },
  { id: 158, type: QuestionType.FILL_IN_BLANK, questionText: "Look _ _ the picture.", correctAnswer: "at", explanation: "Look at: Nhìn vào." },
  { id: 159, type: QuestionType.MULTIPLE_CHOICE, questionText: "I get ... at 6 o’clock in the morning.", options: ["on", "at", "under", "up"], correctAnswer: "up", explanation: "Get up: Thức dậy." },
  { id: 160, type: QuestionType.MULTIPLE_CHOICE, questionText: "How many ... and chairs are there in your classroom?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206432457278227_Audio.mp3"), options: ["tables", "books", "desks", "boards"], correctAnswer: "desks", explanation: "Nghe audio: Desks (bàn học)." },
  { id: 161, type: QuestionType.FILL_IN_BLANK, questionText: "She is painting a _ _ _ _ .", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/25/636787728084913902_566X320.jpg"), correctAnswer: "mask", explanation: "Mask: Mặt nạ." },
  { id: 162, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Mary is", "skipping", "jump", "rope.", "the"], correctAnswer: "Mary is skipping the jump rope.", explanation: "Mary đang nhảy dây." },
  { id: 163, type: QuestionType.MULTIPLE_CHOICE, questionText: "How often do you have Science? – I have it ___ a week.", options: ["twice", "one times", "two times", "three time"], correctAnswer: "twice", explanation: "Twice: Hai lần." },
  { id: 164, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["David.", "your", "teeth", "everyday,", "Brush"], correctAnswer: "Brush your teeth everyday, David.", explanation: "Hãy đánh răng hàng ngày nhé David." },
  { id: 165, type: QuestionType.MULTIPLE_CHOICE, questionText: "Liz is from ___.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/anh/D3_13.jpg"), options: ["Japan", "Australia", "America", "Malaysia"], correctAnswer: "America", explanation: "Liz thường là tên người Mỹ/Anh." },
  { id: 166, type: QuestionType.MULTIPLE_CHOICE, questionText: "Happy ... to you.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206415574644591_Audio.mp3"), options: ["bird", "T-shirt", "Monday", "birthday"], correctAnswer: "birthday", explanation: "Nghe audio: Happy birthday." },
  { id: 167, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["It", "a", "long", "jump rope.", "is"], correctAnswer: "It is a long jump rope.", explanation: "Nó là một cái dây nhảy dài." },
  { id: 168, type: QuestionType.MULTIPLE_CHOICE, questionText: "My house is ....", options: ["this", "that", "big", "many"], correctAnswer: "big", explanation: "Big: To." },
  { id: 169, type: QuestionType.MULTIPLE_CHOICE, questionText: "An anaconda is _______.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790908088568561_Audio.mp3"), options: ["a snake", "a fish", "a big cat", "a bird"], correctAnswer: "a snake", explanation: "Nghe audio/Kiến thức: Anaconda là loài rắn." },
  { id: 170, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ time do you go to bed?", correctAnswer: "What", explanation: "What time: Mấy giờ." },
  { id: 171, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["at home.", "to", "stay", "I", "want"], correctAnswer: "I want to stay at home.", explanation: "Tôi muốn ở nhà." },
  { id: 172, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ done.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790853186671381_Audio.mp3"), correctAnswer: "Well", explanation: "Well done: Làm tốt lắm." },
  { id: 173, type: QuestionType.FILL_IN_BLANK, questionText: "SHE PRACTICES THE VIOLIN ON W_ _ _ _ _ DAY.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/D4_7.mp3"), correctAnswer: "EDNES", explanation: "Wednesday: Thứ Tư." },
  { id: 174, type: QuestionType.FILL_IN_BLANK, questionText: "This is my aunt. She’s E_ _ _ ish.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/anh/D3_3.jpg"), correctAnswer: "ngl", explanation: "English: Người Anh." },
  { id: 175, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["going", "Brush", "before", "to bed.", "your teeth"], correctAnswer: "Brush your teeth before going to bed.", explanation: "Đánh răng trước khi đi ngủ." },
  { id: 176, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["small?", "the", "classroom", "Is"], correctAnswer: "Is the classroom small?", explanation: "Lớp học có nhỏ không?" },
  { id: 177, type: QuestionType.MULTIPLE_CHOICE, questionText: "His father is a _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636161987266871939_Audio.mp3"), correctAnswer: "doctor", explanation: "Nghe audio: doctor." },
  { id: 178, type: QuestionType.FILL_IN_BLANK, questionText: "I like orange jui_ e.", correctAnswer: "c", explanation: "Juice: Nước ép." },
  { id: 179, type: QuestionType.MULTIPLE_CHOICE, questionText: "Tim: ... is Tom from? Mary: England.", options: ["What", "When", "Where", "How"], correctAnswer: "Where", explanation: "Where from: Đến từ đâu." },
  { id: 180, type: QuestionType.MULTIPLE_CHOICE, questionText: "Are these your books? – No, ... .", options: ["this isn’t", "they aren’t", "there aren’t", "they are"], correctAnswer: "they aren’t", explanation: "No, they aren't." },
  { id: 181, type: QuestionType.FILL_IN_BLANK, questionText: "This pencil is s_ all. It’s not big.", correctAnswer: "m", explanation: "Small: Nhỏ." },
  { id: 182, type: QuestionType.FILL_IN_BLANK, questionText: "Mary loves M_ _ _ _ lessons very much.", correctAnswer: "usic", explanation: "Music: Âm nhạc (Hoặc Maths)." },
  { id: 183, type: QuestionType.FILL_IN_BLANK, questionText: "I visit my grandparents _ _ Saturdays.", correctAnswer: "on", explanation: "On + Thứ." },
  { id: 184, type: QuestionType.FILL_IN_BLANK, questionText: "The map is on the w_ _ _ .", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/22/635207423519231386_566X320.jpg"), correctAnswer: "all", explanation: "Wall: Tường." },
  { id: 185, type: QuestionType.FILL_IN_BLANK, questionText: "I like Maths. – When do you h_ _ e it?", correctAnswer: "av", explanation: "Have: Có." },
  { id: 186, type: QuestionType.MULTIPLE_CHOICE, questionText: "What is that? - It’s a ... box.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/22/635207167229230947_566X320.jpg"), options: ["red", "square", "round", "black"], correctAnswer: "square", explanation: "Nhìn tranh: Hình vuông." },
  { id: 187, type: QuestionType.MULTIPLE_CHOICE, questionText: "What are you doing? – I’m ... a book.", options: ["reading", "read", "reads", "to read"], correctAnswer: "reading", explanation: "Reading: Đang đọc." },
  { id: 188, type: QuestionType.FILL_IN_BLANK, questionText: "My school is _ _ Hai Ba Trung District.", correctAnswer: "in", explanation: "In + Quận/Huyện." },
  { id: 189, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen … the teacher, please.", options: ["on", "at", "to", "for"], correctAnswer: "to", explanation: "Listen to: Nghe." },
  { id: 190, type: QuestionType.MULTIPLE_CHOICE, questionText: "My mother can _______ well.", options: ["cooks", "cooking", "cook", "to cook"], correctAnswer: "cook", explanation: "Can + V nguyên thể (cook)." },
  { id: 191, type: QuestionType.MULTIPLE_CHOICE, questionText: "Let’s sing a song with ... .", options: ["the", "my", "me", "mine"], correctAnswer: "me", explanation: "With me: Với tôi." },
  { id: 192, type: QuestionType.FILL_IN_BLANK, questionText: "There are 26 lett_ _ _ in the English alphabet.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/D3_9.mp3"), correctAnswer: "ers", explanation: "Nghe audio: Letters (chữ cái)." },
  { id: 193, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["does", "What", "your sister", "like?", "look"], correctAnswer: "What does your sister look like?", explanation: "Chị gái bạn trông như thế nào?" },
  { id: 194, type: QuestionType.FILL_IN_BLANK, questionText: "My school _ _ in Hoang Hoa Tham Street.", correctAnswer: "is", explanation: "Is: Là/Ở." },
  { id: 195, type: QuestionType.FILL_IN_BLANK, questionText: "How’s the w_ _ ther today? - It’s sunny.", correctAnswer: "ea", explanation: "Weather: Thời tiết." },
  { id: 196, type: QuestionType.FILL_IN_BLANK, questionText: "Put your _ _ nds down, children.", correctAnswer: "ha", explanation: "Hands: Tay." },
  { id: 197, type: QuestionType.MULTIPLE_CHOICE, questionText: "He likes playing sports ... football and tennis.", options: ["such as", "such like", "sample", "example"], correctAnswer: "such as", explanation: "Such as: Như là (liệt kê)." },
  { id: 198, type: QuestionType.MULTIPLE_CHOICE, questionText: "My brother ... like to sing.", options: ["does", "don’t", "doesn’t", "are"], correctAnswer: "doesn’t", explanation: "Doesn't: Không (trợ động từ phủ định)." },
  { id: 199, type: QuestionType.FILL_IN_BLANK, questionText: "An um_ _ _ _ _ _ looks like a mushroom.", imageUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636162021709287251_566X320.jpg"), correctAnswer: "brella", explanation: "Umbrella: Cái ô." },
  { id: 200, type: QuestionType.MULTIPLE_CHOICE, questionText: "I … count to 100.", options: ["cannot", "cant", "can’s", "can not"], correctAnswer: "cannot", explanation: "Cannot: Không thể." }
];

        // --- 3. COMPONENTS ---
        const Button = ({ children, variant = 'primary', size = 'md', className = '', ...props }) => {
             const baseStyles = "inline-flex items-center justify-center font-bold transition-all duration-200 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm transform active:scale-95";
             const variants = {
                primary: "bg-blue-600 hover:bg-blue-700 text-white shadow-blue-500/30 focus:ring-blue-500",
                secondary: "bg-emerald-500 hover:bg-emerald-600 text-white shadow-emerald-500/30 focus:ring-emerald-500",
                danger: "bg-rose-500 hover:bg-rose-600 text-white shadow-rose-500/30 focus:ring-rose-500",
                outline: "bg-white border-2 border-slate-300 text-slate-600 hover:border-blue-500 hover:text-blue-600"
             };
             const sizes = { sm: "px-4 py-1.5 text-sm", md: "px-6 py-3 text-base", lg: "px-8 py-4 text-lg" };
             return <button className={`${baseStyles} ${variants[variant]} ${sizes[size]} ${className}`} {...props}>{children}</button>;
        };

        const StartScreen = ({ onStart }) => {
            const [name, setName] = useState('');
            const handleSubmit = (e) => { e.preventDefault(); if (name.trim()) onStart(name.trim()); };
            return (
                <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-cyan-500 to-blue-600 p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center animate-slide-up">
                        <div className="mb-8">
                            <h1 className="text-3xl font-extrabold text-slate-800 mb-2">IOE K4 ĐỀ SỐ 06</h1>
                            <p className="text-slate-500">Luyện thi tiếng Anh IOE cùng AI Master</p>
                        </div>
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div className="text-left"><label className="block text-sm font-medium text-slate-700 mb-2">Tên của bạn</label><input type="text" value={name} onChange={(e) => setName(e.target.value)} placeholder="Nhập tên..." className="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition-all" required /></div>
                            <Button type="submit" className="w-full" size="lg" disabled={!name.trim()}>Bắt đầu chơi</Button>
                        </form>
                    </div>
                </div>
            );
        };

        const AudioPlayer = ({ src }) => {
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(false);
            const togglePlay = () => { if (audioRef.current) { if (isPlaying) audioRef.current.pause(); else audioRef.current.play(); setIsPlaying(!isPlaying); } };
            return (
                <div className="flex items-center gap-3 bg-slate-100 p-3 rounded-lg border border-slate-200">
                    <button type="button" onClick={togglePlay} className="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors">{isPlaying ? '❚❚' : '▶'}</button>
                    <span className="text-sm font-semibold text-slate-600 uppercase tracking-wide">Nghe câu hỏi</span>
                    <audio ref={audioRef} src={src} onEnded={() => setIsPlaying(false)} className="hidden" />
                </div>
            );
        };

        const QuestionCard = ({ question, onAnswer, isAnswered, userAnswer }) => {
            const [inputVal, setInputVal] = useState('');
            const [selectedParts, setSelectedParts] = useState([]);
            const [showHint, setShowHint] = useState(false);
            const [hintText, setHintText] = useState('');

            useEffect(() => { 
                setInputVal(''); 
                setSelectedParts([]); 
                setShowHint(false);
                setHintText('');
            }, [question.id]);

            const normalize = (str) => str ? str.replace(/[.,!?;:'"]/g, '').replace(/\s+/g, ' ').trim().toLowerCase() : "";
            const isCorrect = () => userAnswer && normalize(userAnswer) === normalize(question.correctAnswer);

            const handleMCSelect = (opt) => !isAnswered && onAnswer(opt);
            const handleInputSubmit = (e) => { e.preventDefault(); if (!isAnswered && inputVal.trim()) onAnswer(inputVal.trim()); };
            const handlePartClick = (part) => { if (!isAnswered) setSelectedParts(prev => prev.includes(part) ? prev.filter(p => p !== part) : [...prev, part]); };
            const handleRearrangeSubmit = () => !isAnswered && selectedParts.length > 0 && onAnswer(selectedParts.join(' '));

            const generateHint = () => {
                if (hintText) return;
                let text = '';
                if (question.type === QuestionType.MULTIPLE_CHOICE) {
                    const wrongOptions = question.options?.filter(opt => opt !== question.correctAnswer) || [];
                    if (wrongOptions.length > 0) {
                         const randomWrong = wrongOptions[Math.floor(Math.random() * wrongOptions.length)];
                         text = `Gợi ý 50/50: Loại bỏ đáp án "${randomWrong}".`;
                    }
                } else if (question.type === QuestionType.FILL_IN_BLANK) {
                     const answer = question.correctAnswer.trim();
                     text = `Từ này có ${answer.length} chữ cái. Bắt đầu bằng "${answer.charAt(0).toUpperCase()}...".`;
                } else {
                     const words = question.correctAnswer.split(' ');
                     const hintPhrase = words.slice(0, Math.max(1, Math.floor(words.length/2))).join(' ');
                     text = `Gợi ý: Câu bắt đầu bằng "${hintPhrase}..."`;
                }
                setHintText(text);
            };

            return (
                <div className="w-full max-w-3xl mx-auto mb-8 animate-fade-in">
                    <div className="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-100">
                        <div className="bg-slate-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <span className="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-extrabold uppercase">{question.type.replace(/_/g, ' ')}</span>
                                {!isAnswered && (
                                    <button onClick={() => { generateHint(); setShowHint(!showHint); }} className="px-3 py-1 text-xs font-bold border rounded-full bg-yellow-50 text-yellow-600 border-yellow-200 hover:bg-yellow-100">
                                        {showHint ? 'Ẩn Gợi ý' : 'Gợi ý'}
                                    </button>
                                )}
                            </div>
                            <span className="text-xs font-bold text-slate-300">ID: {question.id}</span>
                        </div>
                        <div className="p-6 sm:p-10">
                            <div className="mb-6 space-y-4">
                                {question.imageUrl && <div className="flex justify-center"><img src={question.imageUrl} className="max-h-72 rounded-lg shadow-md" onError={(e) => e.target.style.display = 'none'} /></div>}
                                {question.audioUrl && <div className="bg-blue-50 p-4 rounded-xl"><AudioPlayer src={question.audioUrl} /></div>}
                            </div>

                            {showHint && !isAnswered && (
                                <div className="mb-6 bg-yellow-50 p-3 rounded-lg text-sm text-yellow-800 border border-yellow-200">
                                    <strong>Gợi ý:</strong> {hintText}
                                </div>
                            )}

                            <h2 className="text-xl sm:text-2xl font-bold text-slate-800 mb-6">{question.questionText}</h2>
                            
                            {question.type === QuestionType.MULTIPLE_CHOICE && (
                                <div className="grid grid-cols-1 gap-3">
                                    {question.options?.map((opt, idx) => (
                                        <button key={idx} onClick={() => handleMCSelect(opt)} disabled={isAnswered} className={`w-full p-4 rounded-xl text-left border-2 transition-all ${isAnswered ? (opt === question.correctAnswer ? 'bg-green-100 border-green-500 text-green-900' : opt === userAnswer ? 'bg-red-100 border-red-500 text-red-900' : 'bg-slate-50 opacity-60') : 'bg-white hover:border-blue-400 hover:shadow-md'}`}>
                                            <span className="font-bold mr-4 w-6 inline-block">{String.fromCharCode(65 + idx)}</span>{opt}
                                        </button>
                                    ))}
                                </div>
                            )}

                            {question.type === QuestionType.FILL_IN_BLANK && (
                                <form onSubmit={handleInputSubmit} className="flex flex-col gap-2">
                                    <div className="flex gap-3">
                                        <input type="text" value={isAnswered ? userAnswer : inputVal} onChange={(e) => setInputVal(e.target.value)} disabled={isAnswered} className={`flex-1 p-4 rounded-xl border-2 text-lg outline-none ${isAnswered ? (isCorrect() ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50') : 'border-slate-200 focus:border-blue-500'}`} placeholder="Nhập đáp án..." />
                                        {!isAnswered && <Button type="submit">Trả lời</Button>}
                                    </div>
                                    {!isAnswered && <div className="text-xs text-slate-400 text-right">Đã nhập: {inputVal.length} ký tự</div>}
                                </form>
                            )}

                            {question.type === QuestionType.REARRANGE && (
                                <div className="space-y-6">
                                    <div className="flex flex-wrap gap-3 p-4 bg-slate-50 rounded-xl border shadow-inner min-h-[60px]">
                                        {question.rearrangeParts?.map((part, idx) => (
                                            <button key={idx} onClick={() => handlePartClick(part)} disabled={isAnswered || selectedParts.includes(part)} className={`px-4 py-2 rounded-lg bg-white border shadow-sm transition-all active:scale-95 ${selectedParts.includes(part) ? 'opacity-0 pointer-events-none' : 'hover:border-blue-400'}`}>{part}</button>
                                        ))}
                                    </div>
                                    <div className={`min-h-[80px] p-4 rounded-xl border-2 border-dashed flex flex-wrap gap-2 items-center ${isAnswered ? (isCorrect() ? 'border-green-500 bg-green-50/50' : 'border-red-500 bg-red-50/50') : 'border-slate-300 bg-white'}`}>
                                         {selectedParts.length === 0 && !isAnswered && <div className="w-full text-center text-slate-400 italic">Bấm từ để sắp xếp...</div>}
                                        {selectedParts.map((part, idx) => <button key={idx} onClick={() => handlePartClick(part)} disabled={isAnswered} className="bg-blue-100 text-blue-900 px-3 py-1.5 rounded-lg border border-blue-200 font-medium shadow-sm hover:bg-red-100 hover:text-red-800 transition-colors">{part}</button>)}
                                    </div>
                                    {!isAnswered && <div className="flex justify-end"><Button onClick={handleRearrangeSubmit} disabled={selectedParts.length === 0}>Xác nhận</Button></div>}
                                </div>
                            )}

                            {isAnswered && (
                                <div className={`mt-8 p-6 rounded-xl border-l-4 shadow-sm animate-fade-in ${isCorrect() ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>
                                    <div className="flex items-start gap-4">
                                        <div className={`w-8 h-8 rounded-full flex items-center justify-center shrink-0 text-white font-bold ${isCorrect() ? 'bg-green-500' : 'bg-red-500'}`}>{isCorrect() ? '✓' : '✕'}</div>
                                        <div>
                                            <h3 className={`font-bold text-xl mb-2 ${isCorrect() ? 'text-green-800' : 'text-red-800'}`}>{isCorrect() ? 'Chính xác!' : 'Chưa chính xác'}</h3>
                                            {!isCorrect() && <div className="mb-2"><span className="text-red-600 font-bold text-sm uppercase">Đáp án đúng:</span> <span className="font-bold text-slate-800">{question.correctAnswer}</span></div>}
                                            <div className="bg-white/60 p-3 rounded-lg text-slate-700 text-sm"><span className="font-bold text-blue-600 block mb-1">Giải thích:</span>{question.explanation}</div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const QuestionGrid = ({ questions, userAnswers, currentIndex, onJump, onClose }) => {
            const getStatusColor = (q, idx) => {
                const ans = userAnswers.find(a => a.questionId === q.id);
                if (idx === currentIndex) return "ring-2 ring-blue-500 border-blue-500 text-blue-600 bg-white";
                if (!ans) return "bg-slate-100 text-slate-400 border-transparent";
                return ans.isCorrect ? "bg-green-500 text-white border-green-600" : "bg-red-500 text-white border-red-600";
            };
            return (
                <div className="fixed inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                    <div className="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden animate-slide-up">
                        <div className="p-6 border-b flex justify-between items-center bg-slate-50">
                            <div><h2 className="text-xl font-bold">Danh sách câu hỏi</h2><p className="text-sm text-slate-500">Đã làm: {userAnswers.length} / {questions.length}</p></div>
                            <button onClick={onClose} className="p-2 hover:bg-slate-200 rounded-full">✕</button>
                        </div>
                        <div className="flex-1 overflow-y-auto p-6 custom-scrollbar"><div className="grid grid-cols-5 sm:grid-cols-10 gap-3">{questions.map((q, idx) => (<button key={q.id} onClick={() => { onJump(idx); onClose(); }} className={`h-10 w-10 rounded-lg font-bold border transition-all ${getStatusColor(q, idx)}`}>{idx + 1}</button>))}</div></div>
                        <div className="p-4 bg-slate-50 border-t text-xs text-slate-500 flex gap-4 justify-center flex-wrap"><div className="flex items-center gap-2"><span className="w-3 h-3 bg-green-500 rounded-full"></span> Đúng</div><div className="flex items-center gap-2"><span className="w-3 h-3 bg-red-500 rounded-full"></span> Sai</div><div className="flex items-center gap-2"><span className="w-3 h-3 ring-2 ring-blue-500 rounded-full"></span> Đang làm</div><div className="flex items-center gap-2"><span className="w-3 h-3 bg-slate-200 rounded-full"></span> Chưa làm</div></div>
                    </div>
                </div>
            );
        }

        const ResultScreen = ({ userName, userAnswers, onRetryAll, onRetryWrong }) => {
            const correct = userAnswers.filter(a => a.isCorrect).length;
            const total = userAnswers.length;
            const percent = total > 0 ? Math.round((correct/total)*100) : 0;
            const hasWrong = correct < total;
            const score = correct * 10;

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4 animate-fade-in bg-slate-50">
                    <div className="bg-white rounded-3xl shadow-xl p-8 max-w-2xl w-full text-center">
                        <div className="mb-6 relative inline-block">
                            <svg className="w-32 h-32 transform -rotate-90" viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="54" fill="none" stroke="#e2e8f0" strokeWidth="12" />
                                <circle cx="60" cy="60" r="54" fill="none" stroke={percent >= 80 ? '#10b981' : percent >= 50 ? '#3b82f6' : '#ef4444'} strokeWidth="12" strokeDasharray="339.292" strokeDashoffset={339.292 - (339.292 * percent) / 100} className="transition-all duration-1000 ease-out" />
                            </svg>
                            <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-3xl font-bold text-slate-800">{percent}%</div>
                        </div>
                        <h2 className="text-2xl font-bold text-slate-800 mb-2">Hoàn thành bài thi!</h2>
                        <p className="text-slate-600 mb-4">Chúc mừng <b>{userName}</b></p>
                        
                        <div className="mb-8 inline-flex items-baseline gap-2 bg-blue-50 px-6 py-2 rounded-2xl border border-blue-100">
                             <span className="text-4xl font-extrabold text-blue-600">{score}</span>
                             <span className="text-lg text-slate-500 font-bold">điểm</span>
                        </div>

                        <div className="grid grid-cols-2 gap-4 mb-8 bg-slate-50 p-4 rounded-xl">
                            <div><div className="text-2xl font-bold text-green-600">{correct}</div><div className="text-xs uppercase text-slate-500 font-bold">Đúng</div></div>
                            <div className="border-l border-slate-200"><div className="text-2xl font-bold text-red-500">{total - correct}</div><div className="text-xs uppercase text-slate-500 font-bold">Sai</div></div>
                        </div>
                        {hasWrong && (
                            <div className="text-left mb-6 max-h-48 overflow-y-auto custom-scrollbar border-t border-b py-4">
                                <h3 className="text-xs font-bold text-slate-400 uppercase mb-2">Cần xem lại</h3>
                                <div className="space-y-2">
                                    {userAnswers.filter(a => !a.isCorrect).map((ans, i) => {
                                        const q = QUIZ_DATA.find(x => x.id === ans.questionId);
                                        return q ? <div key={i} className="text-sm p-2 bg-red-50 rounded"><span className="font-bold text-red-500 mr-2">#{q.id}</span> {q.questionText} <br/><span className="text-xs text-slate-500">Đáp án: {q.correctAnswer}</span></div> : null;
                                    })}
                                </div>
                            </div>
                        )}
                        <div className="flex gap-4 justify-center">
                            <Button onClick={onRetryAll}>Chơi lại từ đầu</Button>
                            {hasWrong && <Button onClick={onRetryWrong} variant="danger">Làm lại câu sai</Button>}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [gameState, setGameState] = useState(GameState.START);
            const [userName, setUserName] = useState('');
            const [activeQuestions, setActiveQuestions] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [userAnswers, setUserAnswers] = useState([]);
            const [showGrid, setShowGrid] = useState(false);

            const handleStart = (name) => { setUserName(name); startSession(QUIZ_DATA); };
            const startSession = (questions) => { setActiveQuestions(questions); setCurrentIndex(0); setUserAnswers([]); setGameState(GameState.PLAYING); };
            
            const handleAnswer = (response) => {
                const q = activeQuestions[currentIndex];
                const normalize = (s) => s.replace(/[.,!?;:'"]/g, '').replace(/\s+/g, ' ').trim().toLowerCase();
                const isCorrect = normalize(response) === normalize(q.correctAnswer);
                setUserAnswers(prev => [...prev.filter(a => a.questionId !== q.id), { questionId: q.id, userResponse: response, isCorrect }]);
            };

            const handleNext = () => currentIndex < activeQuestions.length - 1 && setCurrentIndex(prev => prev + 1);
            const handlePrev = () => currentIndex > 0 && setCurrentIndex(prev => prev - 1);
            const handleSkip = () => handleNext();
            const handleFinish = () => setGameState(GameState.FINISHED);
            
            const handleRetryWrong = () => {
                const wrongIds = userAnswers.filter(a => !a.isCorrect).map(a => a.questionId);
                startSession(QUIZ_DATA.filter(q => wrongIds.includes(q.id)));
            };

            if (gameState === GameState.START) return <StartScreen onStart={handleStart} />;
            if (gameState === GameState.FINISHED) return <ResultScreen userName={userName} userAnswers={userAnswers} onRetryAll={() => startSession(QUIZ_DATA)} onRetryWrong={handleRetryWrong} />;

            const currentQ = activeQuestions[currentIndex];
            const answer = userAnswers.find(a => a.questionId === currentQ.id);
            const isAnswered = !!answer;
            const isLast = currentIndex === activeQuestions.length - 1;
            const allAnswered = userAnswers.length === activeQuestions.length;
            
            // Calculate Score: 10 points per correct answer
            const currentScore = userAnswers.filter(a => a.isCorrect).length * 10;

            return (
                <div className="min-h-screen bg-slate-100 flex flex-col items-center py-8 px-4 pb-32 relative">
                    <div className="w-full max-w-3xl flex justify-between items-center mb-6 bg-white p-4 rounded-xl shadow-sm">
                        <div className="flex flex-col"><span className="text-xs font-bold text-slate-400 uppercase">Người chơi</span><span className="font-bold text-slate-700">{userName}</span></div>
                        
                        <div className="flex flex-col items-center px-4 border-l border-r border-slate-100">
                             <span className="text-xs font-bold text-slate-400 uppercase">Điểm số</span>
                             <span className="font-bold text-emerald-600 text-xl">{currentScore}</span>
                        </div>

                        <button onClick={() => setShowGrid(true)} className="flex items-center gap-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm font-bold text-slate-600">Danh sách</button>
                        <div className="flex flex-col items-end"><span className="text-xs font-bold text-slate-400 uppercase">Tiến độ</span><span className="font-bold text-blue-600 text-xl">{currentIndex + 1} <span className="text-slate-400 text-sm">/ {activeQuestions.length}</span></span></div>
                    </div>
                    <div className="w-full max-w-3xl bg-slate-200 rounded-full h-2 mb-8 overflow-hidden"><div className="bg-blue-600 h-full transition-all duration-300 ease-out" style={{ width: `${(userAnswers.length / activeQuestions.length) * 100}%` }}></div></div>
                    
                    <QuestionCard question={currentQ} onAnswer={handleAnswer} isAnswered={isAnswered} userAnswer={answer?.userResponse} />
                    
                    <div className="fixed bottom-0 left-0 right-0 p-4 bg-white border-t shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-10">
                        <div className="w-full max-w-3xl mx-auto flex justify-between items-center gap-4">
                            <Button onClick={handlePrev} variant="outline" disabled={currentIndex === 0} className="w-24">← Trước</Button>
                            <div className="flex-1 flex justify-center gap-3">
                                {isAnswered ? (
                                    <>
                                        {!isLast && <Button onClick={handleNext} size="md" className="shadow-xl shadow-blue-500/20 animate-bounce-short">Câu tiếp theo →</Button>}
                                        <Button onClick={handleFinish} variant={allAnswered ? "secondary" : "danger"}>Nộp bài</Button>
                                    </>
                                ) : <Button onClick={handleSkip} variant="outline" className="text-slate-400 hover:text-slate-600">Bỏ qua</Button>}
                            </div>
                            <Button onClick={handleNext} variant="outline" disabled={isLast} className={`w-24 ${isAnswered ? 'opacity-0 pointer-events-none hidden sm:flex' : ''}`}>Sau →</Button>
                        </div>
                    </div>
                    {showGrid && <QuestionGrid questions={activeQuestions} userAnswers={userAnswers} currentIndex={currentIndex} onJump={setCurrentIndex} onClose={() => setShowGrid(false)} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
